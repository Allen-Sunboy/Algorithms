# Homework11

软件13 杨楠

## 1

该问题对应的判定问题的形式语言为：

$$
LONGEST-SIMPLE-CYCLE = \{\langle G, k \rangle: 图G中存在一个长度为k的简单回路\}
$$

先证明，该问题是NP的。给定一个图的实例，以若干顶点组成的序列作为证书。验证这些顶点除了首尾相同之外，没有其他重复的顶点，相邻两个顶点之间存在边，验证序列中点的个数为 $k+1$ ，这一过程可以在多项式时间完成。

接着证明，哈密顿回路问题可以归约到该问题，即 $HAM-CYCLE \le _p LONGEST-SIMPLE-CYCLE$ 。设 $G = (V, E)$ 是HAM-CYCLE的一个实例，且 $|V|=n$ ，那么可构造LONGEST-SIMPLE-CYCLE的实例 $\langle G, n\rangle$ 。可知， $G$ 中存在HAM-CYCLE，当且仅当 $\langle G, n\rangle$ 满足该问题的一个实例。

而哈密顿回路问题是NPC的，可知该问题是NP-hard的，综上，该问题是NP完全的。

## 2

### a.

该问题相关的判定问题的形式化描述为：

$$
INDEPENDENT-SET = \{\langle G, k \rangle: 图G中存在一个大小为k的独立集\}
$$

先证明，该问题是NP的。给定一个图的实例，以若干顶点组成的序列作为证书。验证该序列中顶点个数为 $k$ ，且其中任意两点之间都不相连，这一过程可以在多项式时间完成。

接着证明，团问题可以归纳到该问题，即 $CLIQUE \le _p INDEPENDENT-SET$ 。给定一个图 $G$ ，有一个规模为 $k$ 的团 $V'$ ，即任意两点 $u, v \in V'$ 这两点都相连，那么在 $\bar{G}$ 中，这两点不相连，从而 $V'$ 是 $\bar{G}$ 中大小为 $k$ 的独立集。反之，给定 $\bar{G}$ 一个大小为 $k$ 的独立集 $V'$ ，即任意两点 $u, v \in V'$ 这两点都不相连，那么在 $G$ 中，这两点都相连，从而 $V'$ 是 $G$ 中大小为 $k$ 的团。

而团问题是NPC的，可知该问题是NP-hard的，综上，该问题是NP完全的。


### b.

记该“黑箱”子程序为函数 $EXIST-INDEPENDENT-SET(G, k)$ ，若存在大小为 $k$ 的独立集，则返回1，否则返回0。按照题干，黑箱查询算一步操作，即该黑箱函数的复杂度为 $\Omicron(1)$ 。

设计算法如下。

```python
FIND-INDEPENDENT-SET(G)
    n = |V|
    k = 0
    for i = 1 to n
        if EXIST-INDEPENDENT-SET(G, i)
            k = i
    
    G' = G
    for each u, v in V
        if (u, v) not in E
            add (u, v) to G'
            if !EXIST-INDEPENDENT-SET(G', k)
                remove (u, v) from G'
    
    let S be a new set
    for each v in V'
        if degree(v) < n-1
            add v to S
    return S 
```

首先是算出最大独立集的大小 $k$ 。然后是通过加边，尽量把图填满，而又不改变独立集的大小。如果加入的这条边导致该图不存在大小为 $k$ 的独立集，说明该边的这两个顶点是独立集中必须的。最后是把所有度数小于 $|V|-1$ 的点作为集合，即为最大独立集。算法复杂度为 $\Omicron(|V|+|V||E|)$


### c.

由 $G$ 中每个顶点的度均为2，可知， $G$ 的边的个数为 $|E| = \frac{2|V|}{2} = |V|$ 。

如果图 $G$ 是连通的，那么 $G$ 就是一个环。理由如下：去掉 $G$ 的某一条边，使得图仍保持连通性，那么 $|E| = |V|-1$ ，剩余的图是一棵树。由于只有叶子节点的度数为1，可知该树只有2个叶子节点，而且其他节点的度数为2，即该树为一条链。再将这条边加回去，即构成一个环。

如果图 $G$ 不是连通的，那么对每个连通子图使用上述分析可知，图 $G$ 是由若干个环组成。

对于每个环 $G_i$ ，它的最大独立集中，点的个数为 $\lfloor \frac{|V_i|}{2} \rfloor$ ，因为选取的点不能相邻，至少间隔一个点，如果环上点的个数为偶数则为 $\frac{|V_i|}{2}$ ，如果为奇数则为 $\frac{|V_i|}{2} - 1$ 。

从而设计算法如下：遍历图中的每个环，根据环上点的个数的奇偶性的情况，间隔选取 $\lfloor \frac{|V_i|}{2} \rfloor$ 个点，构成独立集。复杂度为 $\Omicron(|V| + |E|)$ 。

### d.

给定一个二分图 $G=(V, E)$ ，结点集划分为 $V=L \cup R$ ，该二分图的一个最大匹配为 $M$ ，

首先证明，对于二分图，最大匹配数等于最小顶点覆盖数。

可以构建点集合 $V'$ 如下。对于最大匹配 $M$ 的每条边，选取那个和非匹配点有关联的端点，如果这条边的两个端点都没有连接非匹配点，则任选其一。不会存在两个点都与非匹配点有连接的情况，否则可以通过增广路径的构建方法，使得匹配数 $+1$ ，与 $M$ 是最大匹配矛盾。

这样， $|V'|=|M|$ ，这 $|M|$ 个点至少可以覆盖这 $|M|$ 条匹配边。如果还有非匹配边，那么对于每条非匹配边，它的两个端点必然其中一个是匹配点，另一个不是。否则如果两个端点都是非匹配点，那么可以将这条边加入集合 $M$ 使得匹配数 $+1$ ，与 $M$ 是最大匹配矛盾。而由最开始构建 $V'$ 的方式可知，其中的点必然能覆盖到这些边。从而 $V'$ 即为最小顶点覆盖。

接着证明，对于二分图，点集 $V$ 除去最小顶点覆盖 $V'$ 即为最大独立集。如果存在 $u, v \in V-V', (u, v)\in E$ ，这与 $V'$ 是顶点覆盖矛盾。所以任意的 $u, v \in V-V'$ ，这两个点不相连。所以 $V-V'$ 是独立集，又由 $V'$ 是最小顶点覆盖，则 $V-V'$ 就是最大独立集。

由上，设计算法如下：先找到该二分图 $G$ 的一个最大匹配 $M$ ，再由 $M$ 使用上述方法得到最小顶点覆盖 $V'$ ，再获得集合 $V-V'$ 即为图 $G$ 的最大独立集。

找到最大匹配的时间复杂度为 $\Omicron(|V| |E|)$ ，构建最小顶点覆盖的时间为 $\Omicron(|M|)=\Omicron(|E|)$ ，总的时间复杂度为 $\Omicron(|V| |E|)$ 。
